# 🚨 카카오 채널 챗봇 연동 긴급 체크리스트

## 📋 즉시 확인할 사항들 (순서대로)

### 🎯 1단계: 카카오 i 오픈빌더 확인
**🔗 https://i.kakao.com/ 접속**

#### A. 봇 상태 확인
- [ ] **좌측 메뉴 > 봇 관리** 클릭
- [ ] **townly 봇 선택**
- [ ] **상태가 "활성화"인지 확인** ⚠️ 매우 중요!
- [ ] 비활성화 상태라면 → **"활성화" 버튼 클릭**

#### B. 시나리오 설정 (가장 중요!)
- [ ] **좌측 메뉴 > 시나리오** 클릭
- [ ] **폴백 블록이 존재하는지 확인**
- [ ] **폴백 블록 클릭하여 편집**
- [ ] **스킬 호출이 설정되어 있는지 확인**
- [ ] 스킬이 없다면 → **"스킬 추가" 버튼 클릭**
- [ ] **스킬 URL 확인**: `https://2da26f20f041.ngrok-free.app/api/kakao/webhook`

#### C. 기본 응답 설정
- [ ] **시나리오 > 시작 블록** 확인
- [ ] **모든 사용자 입력**이 **폴백 블록**으로 연결되도록 설정
- [ ] **"발화가 분석되지 않는 경우"** → **폴백 블록** 설정

#### D. 스킬 확인
- [ ] **좌측 메뉴 > 스킬** 클릭
- [ ] **웹훅 스킬이 등록되어 있는지 확인**
- [ ] **스킬 상태가 "활성화"인지 확인**
- [ ] **스킬 URL이 정확한지 확인**
- [ ] **"스킬 테스트" 버튼으로 테스트**

#### E. 배포 상태
- [ ] **우상단 "배포" 버튼 클릭**
- [ ] **"배포" 상태인지 확인**
- [ ] 배포되지 않았다면 → **"배포하기" 클릭**

### 🎯 2단계: 카카오톡 채널 관리자센터 확인
**🔗 https://center-pf.kakao.com/ 접속**

#### A. 챗봇 연결 상태
- [ ] **관리 > 채팅** 메뉴 클릭
- [ ] **챗봇 연결** 섹션 확인
- [ ] **"활성화" 상태인지 확인** ⚠️ 매우 중요!
- [ ] **연결된 챗봇이 "townly"인지 확인**

#### B. 자동응답 설정
- [ ] **자동응답 설정** 확인
- [ ] **"챗봇 우선" 또는 "챗봇 전용"으로 설정** ⚠️ 매우 중요!
- [ ] **일반 자동응답이 "비활성화"인지 확인**
- [ ] **키워드 자동응답이 "비활성화"인지 확인**

#### C. 채널 상태
- [ ] **채널이 "공개" 상태인지 확인**
- [ ] **검색 허용이 "활성화"인지 확인**

### 🎯 3단계: 웹훅 URL 확인

현재 ngrok URL: `https://2da26f20f041.ngrok-free.app/api/kakao/webhook`

#### A. ngrok 상태 확인
터미널에서 실행:
```bash
curl -X GET "https://2da26f20f041.ngrok-free.app/api/health"
```

#### B. 새로운 ngrok URL 확인 (필요시)
```bash
ngrok http 3000
```
새 URL이 나오면 카카오 i 오픈빌더의 스킬 URL 업데이트

### 🎯 4단계: 테스트

#### A. 카카오 i 오픈빌더에서 테스트
- [ ] **스킬 > 스킬 테스트** 실행
- [ ] **응답이 정상적으로 오는지 확인**

#### B. 실제 카카오톡 테스트
- [ ] 카카오톡에서 "Townly" 검색
- [ ] 채널 추가
- [ ] **"안녕하세요" 메시지 전송**
- [ ] **챗봇 응답 확인**

## 🔧 문제별 해결책

### ❌ 문제: 봇이 비활성화됨
**✅ 해결**: 카카오 i 오픈빌더 > 봇 관리 > 활성화 > 배포

### ❌ 문제: 폴백 블록에 스킬이 없음
**✅ 해결**: 시나리오 > 폴백 블록 > 스킬 추가 > 웹훅 스킬 선택

### ❌ 문제: 챗봇 연결이 비활성화됨
**✅ 해결**: 채널 관리자센터 > 관리 > 채팅 > 챗봇 연결 활성화

### ❌ 문제: 자동응답이 챗봇을 방해함
**✅ 해결**: 자동응답을 "챗봇 우선"으로 변경, 일반 자동응답 비활성화

### ❌ 문제: ngrok URL 변경됨
**✅ 해결**: 새 ngrok URL로 스킬 URL 업데이트 후 배포

## 🚨 가장 자주 놓치는 실수

1. **봇 활성화 후 배포를 안 함** ← 90% 원인
2. **폴백 블록에 스킬 연결을 안 함** ← 80% 원인  
3. **채널에서 챗봇 연결을 활성화 안 함** ← 70% 원인
4. **자동응답이 챗봇보다 우선되어 있음** ← 60% 원인

## ✅ 체크 완료 후

모든 설정을 확인한 후:
1. **카카오 i 오픈빌더에서 "배포" 클릭**
2. **5-10분 대기** (배포 시간)
3. **카카오톡에서 메시지 테스트**
4. **모니터링 도구로 메시지 수신 확인**

---

**📞 추가 도움이 필요하면:**
- 카카오 i 오픈빌더 고객센터: https://cs.kakao.com/
- 개발자 문서: https://i.kakao.com/docs/

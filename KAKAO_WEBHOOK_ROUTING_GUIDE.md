# π”„ μΉ΄μΉ΄μ¤ μ™„μ „ν• μ›Ήν›… λΌμ°ν… μ„¤μ • κ°€μ΄λ“

## π― λ©ν‘
λ¨λ“  μ‚¬μ©μ λ©”μ‹μ§€(λ‚ μ”¨ μ§λ¬Έ ν¬ν•¨)λ¥Ό μ›Ήν›…(`/api/kakao/webhook`)μΌλ΅ λΌμ°ν…ν•μ—¬ ν†µν•© μ²λ¦¬

## π“‹ ν„μ¬ λ¬Έμ 
- λ‚ μ”¨ μ§λ¬Έμ΄ λ³„λ„ μ¤ν‚¬(`/api/kakao/skills/weather-rag`)λ΅ λΌμ°ν…λ¨
- μ΄λ΅ μΈν•΄ λ©”μ‹μ§€ μ €μ¥ λ° admin νμ΄μ§€ ν‘μ‹ λ¬Έμ  λ°μƒ

## β… ν•΄κ²° λ°©μ•: μ™„μ „ν• μ›Ήν›… λΌμ°ν…

### π”§ **1λ‹¨κ³„: μΉ΄μΉ΄μ¤ i μ¤ν”λΉλ” μ„¤μ • λ³€κ²½**

#### A. μΉ΄μΉ΄μ¤ i μ¤ν”λΉλ” μ ‘μ†
1. **μΉ΄μΉ΄μ¤ i μ¤ν”λΉλ”** (https://i.kakao.com/) μ ‘μ†
2. **"townly" λ΄‡** μ„ νƒ

#### B. κΈ°μ΅΄ λ‚ μ”¨ μ¤ν‚¬ λΉ„ν™μ„±ν™”
1. **"μ¤ν‚¬"** λ©”λ‰΄ ν΄λ¦­
2. λ‚ μ”¨ κ΄€λ ¨ μ¤ν‚¬λ“¤ ν™•μΈ:
   - `weather-rag` μ¤ν‚¬
   - `weather` μ¤ν‚¬
3. **κ° μ¤ν‚¬μ "λΉ„ν™μ„±ν™”"** λ²„νΌ ν΄λ¦­
4. β οΈ **μ¤‘μ”**: μ¤ν‚¬μ„ μ‚­μ ν•μ§€ λ§κ³  λΉ„ν™μ„±ν™”λ§ ν•μ„Έμ”

#### C. μ›Ήν›… μ¤ν‚¬ μ„¤μ • ν™•μΈ/μμ •
1. **"μ¤ν‚¬"** λ©”λ‰΄μ—μ„ **μ›Ήν›… μ¤ν‚¬** μ°ΎκΈ°
2. μ¤ν‚¬ URLμ΄ λ‹¤μκ³Ό κ°™μ΄ μ„¤μ •λμ–΄ μλ”μ§€ ν™•μΈ:
   ```
   https://townly.vercel.app/api/kakao/webhook
   ```
3. μ¤ν‚¬μ΄ **"ν™μ„±ν™”"** μƒνƒμΈμ§€ ν™•μΈ

#### D. μ‹λ‚λ¦¬μ¤ μ„¤μ • (κ°€μ¥ μ¤‘μ”!)
1. **"μ‹λ‚λ¦¬μ¤"** λ©”λ‰΄ ν΄λ¦­
2. **"ν΄λ°± λΈ”λ΅"** μ„¤μ •:
   ```
   ν΄λ°± λΈ”λ΅ β†’ μ¤ν‚¬ νΈμ¶ β†’ μ›Ήν›… μ¤ν‚¬ μ„ νƒ
   ```
3. **"Welcome λΈ”λ΅"** μ„¤μ •:
   ```
   Welcome λΈ”λ΅ β†’ μ¤ν‚¬ νΈμ¶ β†’ μ›Ήν›… μ¤ν‚¬ μ„ νƒ
   ```

#### E. μ—”ν‹°ν‹° λ° μΈν…νΈ μ„¤μ • μ κ±°
1. **"μ—”ν‹°ν‹°"** λ©”λ‰΄μ—μ„ λ‚ μ”¨ κ΄€λ ¨ μ—”ν‹°ν‹° **λΉ„ν™μ„±ν™”**
2. **"μΈν…νΈ"** λ©”λ‰΄μ—μ„ λ‚ μ”¨ κ΄€λ ¨ μΈν…νΈ **λΉ„ν™μ„±ν™”**
3. β οΈ **μ¤‘μ”**: νΉμ • μΈν…νΈκ°€ λ‚ μ”¨ μ¤ν‚¬λ΅ λΌμ°ν…λμ§€ μ•λ„λ΅ λ¨λ“  μ„¤μ • μ κ±°

### π”§ **2λ‹¨κ³„: μ‹λ‚λ¦¬μ¤ ν”λ΅μ° ν™•μΈ**

#### μ¬λ°”λ¥Έ ν”λ΅μ°:
```
μ‚¬μ©μ λ©”μ‹μ§€ μ…λ ¥
    β†“
ν΄λ°± λΈ”λ΅ (λ¨λ“  λ©”μ‹μ§€ μ²λ¦¬)
    β†“
μ›Ήν›… μ¤ν‚¬ νΈμ¶
    β†“
/api/kakao/webhook μ—”λ“ν¬μΈνΈ
    β†“
λ‚ μ”¨ μ§λ¬Έ κ°μ§€ λ΅μ§
    β†“
[λ‚ μ”¨ μ§λ¬Έ] β†’ μ—μ΄μ „νΈ RAG μ‹μ¤ν…
[μΌλ° λ€ν™”] β†’ Claude μ‹μ¤ν…
    β†“
ν†µν•© μ‘λ‹µ μ κ³µ
```

#### μλ»λ ν”λ΅μ° (ν„μ¬):
```
μ‚¬μ©μ λ©”μ‹μ§€ μ…λ ¥
    β†“
μΈν…νΈ λ¶„μ„
    β†“
[λ‚ μ”¨ κ΄€λ ¨] β†’ weather-rag μ¤ν‚¬
[μΌλ° λ€ν™”] β†’ μ›Ήν›… μ¤ν‚¬
    β†“
λ¶„λ¦¬λ μ²λ¦¬ (λ¬Έμ !)
```

### π”§ **3λ‹¨κ³„: ν…μ¤νΈ λ° κ²€μ¦**

#### A. ν…μ¤νΈ λ©”μ‹μ§€λ“¤
λ‹¤μ λ©”μ‹μ§€λ“¤μ΄ λ¨λ‘ μ›Ήν›…μΌλ΅ λΌμ°ν…λλ”μ§€ ν™•μΈ:

**λ‚ μ”¨ μ§λ¬Έ:**
- "μ¤λ λ‚ μ”¨ μ–΄λ•?"
- "λ‚΄μΌ λΉ„κ°€ μ¤λ‚?"
- "9μ›” 29μΌ λ‚ μ”¨λ¥Ό μ•λ ¤μ¤"

**μΌλ° λ€ν™”:**
- "μ•λ…•ν•μ„Έμ”"
- "λ§›μ§‘ μ¶”μ²ν•΄μ¤"
- "κ³ λ§μ›"

#### B. ν™•μΈ μ‚¬ν•­
1. **μ„λ²„ λ΅κ·Έ**μ—μ„ λ‹¤μ λ©”μ‹μ§€ ν™•μΈ:
   ```
   π” λ‚ μ”¨ μ§λ¬Έ κ°μ§€: true (μ‹ λΆ°λ„: 0.85)
   π¤οΈ λ‚ μ”¨ μ§λ¬ΈμΌλ΅ κ°μ§€λ¨ - μ—μ΄μ „νΈ RAG μ‹μ¤ν… νΈμ¶
   ```

2. **Admin νμ΄μ§€**μ—μ„ λ¨λ“  λ©”μ‹μ§€κ°€ ν‘μ‹λλ”μ§€ ν™•μΈ

3. **μ‘λ‹µ νƒ€μ…** ν™•μΈ:
   - λ‚ μ”¨ μ§λ¬Έ: `weather_agent_rag`
   - μΌλ° λ€ν™”: `claude`

### π¨ **μ£Όμμ‚¬ν•­**

#### A. λ°±μ—…
- μ„¤μ • λ³€κ²½ μ „ ν„μ¬ μ‹λ‚λ¦¬μ¤ μ„¤μ •μ„ **μ¤ν¬λ¦°μƒ·**μΌλ΅ λ°±μ—…
- μ¤ν‚¬μ„ μ‚­μ ν•μ§€ λ§κ³  **λΉ„ν™μ„±ν™”**λ§ ν•μ„Έμ”

#### B. μ μ§„μ  μ μ©
1. λ¨Όμ € **ν…μ¤νΈ ν™κ²½**μ—μ„ ν™•μΈ
2. μ •μƒ μ‘λ™ ν™•μΈ ν›„ **ν”„λ΅λ•μ… μ μ©**

#### C. λ΅¤λ°± κ³„ν
λ¬Έμ  λ°μƒ μ‹:
1. λ‚ μ”¨ μ¤ν‚¬ **μ¬ν™μ„±ν™”**
2. μ‹λ‚λ¦¬μ¤μ—μ„ **μΈν…νΈ κΈ°λ° λΌμ°ν…** λ³µμ›

### π“ **μμƒ κ²°κ³Ό**

#### Before (ν„μ¬):
```
"9μ›” 29μΌ λ‚ μ”¨λ¥Ό μ•λ ¤μ¤"
    β†“
weather-rag μ¤ν‚¬ (/api/kakao/skills/weather-rag)
    β†“
DB μ €μ¥ μ•λ¨ β†’ Admin νμ΄μ§€μ— ν‘μ‹ μ•λ¨
```

#### After (λ©ν‘):
```
"9μ›” 29μΌ λ‚ μ”¨λ¥Ό μ•λ ¤μ¤"
    β†“
μ›Ήν›… (/api/kakao/webhook)
    β†“
λ‚ μ”¨ κ°μ§€ β†’ μ—μ΄μ „νΈ RAG νΈμ¶
    β†“
DB μ €μ¥λ¨ β†’ Admin νμ΄μ§€μ— ν‘μ‹λ¨
```

### π― **μ„¤μ • μ™„λ£ ν›„ κΈ°λ€ ν¨κ³Ό**

1. **β… ν†µν•© λ©”μ‹μ§€ κ΄€λ¦¬**: λ¨λ“  λ©”μ‹μ§€κ°€ admin νμ΄μ§€μ—μ„ ν™•μΈ κ°€λ¥
2. **β… μΌκ΄€λ μ‘λ‹µ ν’μ§**: μ—μ΄μ „νΈ κΈ°λ° λ‚ μ”¨ μ‘λ‹µ
3. **β… κ°„νΈν• λ””λ²„κΉ…**: λ‹¨μΌ μ—”λ“ν¬μΈνΈλ΅ λ¨λ“  λ΅κ·Έ ν™•μΈ
4. **β… ν™•μ¥μ„±**: μƒλ΅μ΄ κΈ°λ¥ μ¶”κ°€ μ‹ μ›Ήν›…μ—μ„ ν†µν•© μ²λ¦¬

---

## π”§ **μ‹¤ν–‰ μ²΄ν¬λ¦¬μ¤νΈ**

- [ ] μΉ΄μΉ΄μ¤ i μ¤ν”λΉλ” μ ‘μ†
- [ ] λ‚ μ”¨ κ΄€λ ¨ μ¤ν‚¬λ“¤ λΉ„ν™μ„±ν™”
- [ ] μ›Ήν›… μ¤ν‚¬ ν™μ„±ν™” ν™•μΈ
- [ ] ν΄λ°± λΈ”λ΅ β†’ μ›Ήν›… μ¤ν‚¬ μ—°κ²°
- [ ] λ‚ μ”¨ κ΄€λ ¨ μΈν…νΈ/μ—”ν‹°ν‹° λΉ„ν™μ„±ν™”
- [ ] ν…μ¤νΈ λ©”μ‹μ§€ μ „μ†΅
- [ ] μ„λ²„ λ΅κ·Έ ν™•μΈ
- [ ] Admin νμ΄μ§€ ν™•μΈ

**μ΄ κ°€μ΄λ“λ¥Ό λ”°λΌ μ„¤μ •ν•λ©΄ λ¨λ“  λ©”μ‹μ§€κ°€ μ›Ήν›…μΌλ΅ λΌμ°ν…λμ–΄ ν†µν•© μ²λ¦¬λ©λ‹λ‹¤!** π‰
